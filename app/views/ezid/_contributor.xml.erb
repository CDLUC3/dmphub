<%# locals: contributor, type %>
<contributor contributorType="<%= type %>">
  <% if contributor.is_a?(Contributor) %>
    <contributorName nameType="Personal"><%= contributor.name_last_first %></contributorName>
    <% if contributor.orcids.any? %>
      <nameIdentifier nameIdentifierScheme="ORCID"><%= contributor.orcids.last.value %></nameIdentifier>
    <% end %>
    <% if contributor.affiliation.present? && contributor.affiliation.rors.any? %>
      <affiliation affiliationIdentifier="<%= contributor.affiliation.rors.last.value %>" affiliationIdentifierScheme="ROR"><%= contributor.affiliation.name %></affiliation>
    <% end %>

  <% elsif contributor.is_a?(Affiliation) %>
    <contributorName nameType="Organizational"><%= contributor.name %></contributorName>
    <% if contributor.rors.any? %>
      <nameIdentifier nameIdentifierScheme="ROR"><%= contributor.rors.last.value %></nameIdentifier>
    <% end %>

  <% else %>
    <contributorName nameType="Organizational"><%= contributor.fetch(:name, ApplicationService.application_name) %></contributorName>
    <% if contributor[:identifier].present? && contributor[:scheme].present? %>
      <nameIdentifier nameIdentifierScheme="<%= contributor[:scheme] %>"><%= contributor[:identifier] %></nameIdentifier>
    <% end %>
  <% end %>
</contributor>
